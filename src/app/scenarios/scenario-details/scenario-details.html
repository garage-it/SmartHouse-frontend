<div class="page-header">
    <a class="back-link" (click)="back()">
        <i class="material-icons md-18">navigate_before</i>
        Back to list
    </a>
    <div class="row">
        <div class="col s12">
            <a href="" class="nav-link right">
                <i class="material-icons">edit</i>
                Go to Wizard
            </a>
        </div>
    </div>
</div>

<form class="scenario-details" (ngSubmit)="save(scenario)">
    <div class="row">
        <div class="input-field col s6">
            <input id="first_name" type="text" placeholder="Enter descriptive scenario name"
                   [(ngModel)]="scenario.name"/>
            <label for="first_name">Scenario name:</label>
        </div>
    </div>

    <div class="row">
        <div class="col">
            <h5>If condition is true</h5>
        </div>
    </div>

    <div class="row gray-bg" *ngFor="#condition of scenario.conditions">
        <div class="col s3">
            <span>Device</span>
            <select [(ngModel)]="condition.selectedDevice">
                <option [value]="undefined">Choose trigger</option>
                <option *ngFor="#device of condition.devices"
                        [value]="device._id">{{device.description}}</option>
            </select>
        </div>
        <div class="col s3">
            <span>Condition</span>
            <select [(ngModel)]="condition.selectedCondition">
                <option [value]="undefined">Choose condition</option>
                <option *ngFor="#condition of condition.conditions" [value]="condition.id">{{condition.name}}</option>
            </select>
        </div>
        <div class="col s5">
            <span>Value</span>
            <input type="text" placeholder="Enter value"
                   [(ngModel)]="condition.value"/>
        </div>
        <div class="col s1" *ngIf="scenario.conditions.length>1">
            <div>
                <i class="material-icons center"
                   (click)="removeCriteria()"
                >delete</i>
            </div>
        </div>
    </div>
    <div class="row">
        <a (click)="addCriteria()">+ ADD CRITERIA</a>
    </div>
    <div class="row">
        <div class="col">
            <h5>Then do the following</h5>
        </div>
    </div>
    <div class="row gray-bg" *ngFor="#action of scenario.actions">
        <div class="col s3">
            <span>Device</span>
            <select [(ngModel)]="action.selectedDevice">
                <option [value]="undefined">Choose device</option>
                <option *ngFor="#device of action.devices"
                        [value]="device._id">{{device.description}}</option>
            </select>
        </div>
        <div class="col s3">
            <span>Value</span>
            <select [(ngModel)]="action.selectedValue">
                <option *ngFor="#value of action.values">{{value.name}}</option>
            </select>
        </div>
        <div class="col s1" *ngIf="scenario.actions.length>1">
            <div>
                <i (click)="removeAction()" class="material-icons center">delete</i>
            </div>
        </div>
    </div>

    <div class="row">
        <a (click)="addAction()">+ ADD ACTION</a>
    </div>

    <p class="sensor-detail__status">
        <input [(ngModel)]="scenario.active"
               class="filled-in sensor-detail__status-value"
               type="checkbox" id="scenario-details__status"/>
        <label for="scenario-details__status">active </label>
    </p>

    <label>
        Scenario description:
        <input [(ngModel)]="scenario.description"
            class="black-text"
            type="text"/>
    </label>

    <div class="scenario-details_editor-wrapper">
        <scenario-editor
            [scenario]="scenario?.body"
            (updateScenario)="onScenarioBodyUpdate($event)">
        </scenario-editor>
    </div>

    <button class="waves-effect waves-light btn blue-grey darken-1" type="submit">SAVE SCENARIO</button>
</form>
